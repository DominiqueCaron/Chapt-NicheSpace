rm(list = ls())
library(dplyr)
library(rgbif)
library(purrr)
Tetrapod_traits <- read.csv("data/checkpoints/TetrapodTraits.csv", row.names = 1)
setwd("..")
Tetrapod_traits <- read.csv("data/checkpoints/TetrapodTraits.csv", row.names = 1)
### European metaweb
Euro_species <- read.csv("data/cleaned/EuroMWTaxo.csv", row.names = 1)
Euro_traits <- Tetrapod_traits %>%
select(-Order, - Family, -Genus) %>%
right_join(Euro_species, by = c("Best_guess_binomial" = "Species"))
View(Euro_traits)
View(Euro_species)
View(Euro_traits)
View(Tetrapod_traits)
Euro_traits <- Tetrapod_traits %>%
select(-Order, - Family, -Genus) %>%
right_join(Euro_species, by = c("Species" = "Species"))
Euro_traits <- Tetrapod_traits %>%
select(-Order, - Family, -Genus) %>%
right_join(Euro_species)
View(Euro_traits)
View(Tetrapod_traits)
head(Tetrapod_traits)
length(unique(Tetrapod_traits$Species))
sum(is.na(Tetrapod_traits$Species))
View(Tetrapod_traits)
View(Tetrapod_traits[is.na(Tetrapod_traits$Species),])
length(unique(Euro_traits$Species))
length(unique(Euro_species$Species))
Euro_traits <- Tetrapod_traits %>%
right_join(Euro_species, by = "Species")
head(Euro_traits)
Euro_traits <- Tetrapod_traits %>%
select(-Order, -Family, -Genus, -Best_guess_binomial)
right_join(Euro_species, by = "Species")
Euro_traits <- Tetrapod_traits %>%
select(-Order, -Family, -Genus, -Best_guess_binomial) %>%
right_join(Euro_species, by = "Species")
View(Euro_traits)
?tabulate
str(Euro_traits)
is.numeric(Euro_traits)
apply(Euro_traits, MARGIN = 1, is.numeric)
apply(Euro_traits, MARGIN = 2, is.numeric)
apply(Euro_traits, MARGIN = 2, is.integer)
?mode
source("code/functions.R")
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select_if(!is.numeric)
?select_if
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select_if(-is.numeric)
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select_if(is.numeric)
View(Euro_traits)
View(Euro_traits_nonnum)
View(Euro_traits)
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select(Species, vars(Trophic_level:Other.Unknown), vars(Class:Genus))
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select(Species, across(where(!is.numeric)))
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
dplyr::select(Species, across(where(!is.numeric)))
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select(across(where(!is.numeric)))
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select(across(where(is.numeric)))
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select(where(is.numeric))
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select(where(!is.numeric))
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select(where(-is.numeric))
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select(where(is.numeric == F))
View(Tetrapod_traits)
View(Euro_traits_nonnum)
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select_at(vars(Species, Trophic_level:Other.Unknown))
Euro_traits <- Tetrapod_traits %>%
select(-Order, -Family, -Genus, -Best_guess_binomial) %>%
right_join(Euro_species, by = "Species") %>%
filter(!is.na(Species))
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select_at(vars(Species, Trophic_level:Other.Unknown))
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select_at(vars(Species, Trophic_level:Other.Unknown, Class:Genus)) %>%
group_by(Species) %>%
summarise_all(getmode)
getmode(c(0,1))
getmode(c(0,1,1))
# Take the mode of non-numeric columns
Euro_traits_nonnum <- Euro_traits %>%
select_at(vars(Species, Trophic_level:Other.Unknown, Class:Genus)) %>%
group_by(Species) %>%
summarise_all(getmode) %>%
mutate_at(vars(-Species), as.factor)
str(Euro_traits_nonnum)
View(Euro_traits)
?mean
# Take the mean of numeric columns
Euro_traits_num <- Euro_traits %>%
select_at(vars(Species, Body_length_mm:Litter_clutch_size, Adult_svl_cm:Generation_length_d)) %>%
group_by(Species) %>%
summarise_all(mean, na.rm = T) %>%
mutate_at(vars(-Species), as.numeric)
View(Euro_traits_num)
str(Euro_traits_num)
is.na(Euro_traits_num[1,])
Euro_traits <- full_join(Euro_traits_nonnum, Euro_traits_num)
View(Euro_traits)
completeness <- apply(Euro_traits, margin = 2, sum(is.na))
?apply()
completeness <- apply(Euro_traits, margin = 2, function (x) sum(is.na(x))/length(x))
completeness <- apply(Euro_traits, MARGIN = 2, function (x) sum(is.na(x))/length(x))
completeness <- apply(Euro_traits, MARGIN = 2, function (x) sum(!is.na(x))/length(x))
completeness
View(Euro_traits)
Serengeti_species <- read.csv("data/cleaned/SerengetiFWTaxo.csv", row.names = 1)
Serengeti_traits <- Tetrapod_traits %>%
select(-Order, -Family, -Genus, -Best_guess_binomial) %>%
right_join(Serengeti_species, by = "Species") %>%
filter(!is.na(Species))
View(Serengeti_traits)
### Serengeti FW
Serengeti_species <- read.csv("data/cleaned/SerengetiFWTaxo.csv", row.names = 1)
Serengeti_traits <- Tetrapod_traits %>%
select(-Order, -Family, -Genus, -Best_guess_binomial) %>%
right_join(Serengeti_species, by = "Species") %>%
filter(!is.na(Species))
# Take the mode of non-numeric columns
Serengeti_traits_nonnum <- Serengeti_traits %>%
select_at(vars(Species, Trophic_level:Other.Unknown, Class:Genus)) %>%
group_by(Species) %>%
summarise_all(getmode) %>%
mutate_at(vars(-Species), as.factor)
# Take the mean of numeric columns
Serengeti_traits_num <- Serengeti_traits %>%
select_at(vars(Species, Body_length_mm:Litter_clutch_size, Adult_svl_cm:Generation_length_d)) %>%
group_by(Species) %>%
summarise_all(mean, na.rm = T) %>%
mutate_at(vars(-Species), as.numeric)
Serengeti_traits <- full_join(Serengeti_traits_nonnum, Serengeti_traits_num)
completeness <- apply(Serengeti_traits, MARGIN = 2, function (x) sum(!is.na(x))/length(x))
completeness
Pyrennees_species <- read.csv("data/cleaned/pyrenneesFWTaxo.csv", row.names = 1)
Pyrennees_traits <- Tetrapod_traits %>%
select(-Order, -Family, -Genus, -Best_guess_binomial) %>%
right_join(Pyrennees_species, by = "Species") %>%
filter(!is.na(Species))
### Pyrennees FW
Pyrennees_species <- read.csv("data/cleaned/pyrenneesFWTaxo.csv", row.names = 1)
Pyrennees_traits <- Tetrapod_traits %>%
select(-Order, -Family, -Genus, -Best_guess_binomial) %>%
right_join(Pyrennees_species, by = "Species") %>%
filter(!is.na(Species))
# Take the mode of non-numeric columns
Pyrennees_traits_nonnum <- Pyrennees_traits %>%
select_at(vars(Species, Trophic_level:Other.Unknown, Class:Genus)) %>%
group_by(Species) %>%
summarise_all(getmode) %>%
mutate_at(vars(-Species), as.factor)
# Take the mean of numeric columns
Pyrennees_traits_num <- Pyrennees_traits %>%
select_at(vars(Species, Body_length_mm:Litter_clutch_size, Adult_svl_cm:Generation_length_d)) %>%
group_by(Species) %>%
summarise_all(mean, na.rm = T) %>%
mutate_at(vars(-Species), as.numeric)
Pyrennees_traits <- full_join(Pyrennees_traits_nonnum, Pyrennees_traits_num)
completeness <- apply(Pyrennees_traits, MARGIN = 2, function (x) sum(!is.na(x))/length(x))
completeness
HighArctic_species <- read.csv("data/cleaned/HighArcticFWTaxo.csv", row.names = 1)
HighArctic_traits <- Tetrapod_traits %>%
select(-Order, -Family, -Genus, -Best_guess_binomial) %>%
right_join(HighArctic_species, by = "Species") %>%
filter(!is.na(Species))
### High Arctic FW
HighArctic_species <- read.csv("data/cleaned/HighArcticFWTaxo.csv", row.names = 1)
HighArctic_traits <- Tetrapod_traits %>%
select(-Order, -Family, -Genus, -Best_guess_binomial) %>%
right_join(HighArctic_species, by = "Species") %>%
filter(!is.na(Species))
# Take the mode of non-numeric columns
HighArctic_traits_nonnum <- HighArctic_traits %>%
select_at(vars(Species, Trophic_level:Other.Unknown, Class:Genus)) %>%
group_by(Species) %>%
summarise_all(getmode) %>%
mutate_at(vars(-Species), as.factor)
# Take the mean of numeric columns
HighArctic_traits_num <- HighArctic_traits %>%
select_at(vars(Species, Body_length_mm:Litter_clutch_size, Adult_svl_cm:Generation_length_d)) %>%
group_by(Species) %>%
summarise_all(mean, na.rm = T) %>%
mutate_at(vars(-Species), as.numeric)
HighArctic_traits <- full_join(HighArctic_traits_nonnum, HighArctic_traits_num)
completeness <- apply(HighArctic_traits, MARGIN = 2, function (x) sum(!is.na(x))/length(x))
completeness
write.csv(Euro_traits, "data/cleaned/EuroTraits.csv")
write.csv(Serengeti_traits, "data/cleaned/SerengetiTraits.csv")
write.csv(Pyrennees_traits, "data/cleaned/PyrenneesTraits.csv")
write.csv(HighArctic_traits, "data/cleaned/HighArcticTraits.csv")
?sample
sum(Serengeti_traits$Species %in% Euro_traits$Species)
sum(Serengeti_traits$Species %in% Euro_traits$Species) / nrow(Serengeti_traits$Species)
sum(Serengeti_traits$Species %in% Euro_traits$Species) / nrow(Serengeti_traits)
sum(Pyrennees_traits$Species %in% Euro_traits$Species) / nrow(Pyrennees_traits)
sum(Pyrennees_traits$Species %in% Euro_traits$Species)
sum(HighArctic_traits$Species %in% Euro_traits$Species) / nrow(HighArctic_traits)
sum(HighArctic_traits$Species %in% Euro_traits$Species)
sum(Serengeti_traits$Family %in% Euro_traits$Family) / nrow(Serengeti_traits)
